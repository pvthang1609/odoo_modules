<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="price_list_product_action" model="ir.actions.act_window">
        <field name="name">Bảng giá</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">sale.order.price.list.product</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="price_list_product_view" model="ir.ui.view">
        <field name="name">Bảng giá</field>
        <field name="model">sale.order.price.list.product</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string="Bảng giá">
                <field name="name"/>
                <field name="selected_common_name"/>
                <field name="selected_product_id"/>
                <field name="selected_price"/>
                <field name="selected_product_origin" optional="hide"/>
                <field name="selected_manufacturer" optional="hide"/>
                <field name="selected_partner"/>
                <field name="selected_description"/>
                <field name="selected_attachments" optional="hide"/>
                <field name="origin_common_name" optional="hide"/>
                <field name="origin_product_id" optional="hide"/>
                <field name="standard_price_target" optional="hide"/>
                <field name="origin_product_origin" optional="hide"/>
                <field name="origin_manufacturer" optional="hide"/>
                <field name="origin_description" optional="hide"/>
                <field name="origin_attachments" optional="hide"/>
                <field name="origin"/>
                <field name="count_price_lines"/>
                <field name="note"/>
                <field name="state" decoration-success="state in ['done']" decoration-danger="state in ['processing']"/>
            </tree>
        </field>
    </record>

    <record id="price_list_product_form" model="ir.ui.view">
        <field name="name">Form bảng giá</field>
        <field name="model">sale.order.price.list.product</field>
        <field name="arch" type="xml">
            <form string="Form bảng giá">
                <header>
                    <button string="Thông báo đề xuất" class="oe_highlight" title="Thông báo đề xuất NCC tới TPXNK"/>
                    <field name="state" widget="statusbar" statusbar_visible="processing,selected,buyed"/>
                </header>

                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="origin"/>
                        </group>
                        <group>
                            <field name="ei_executive_ids" widget="many2many_tags"/>
                        </group>
                    </group>

                    <group>
                        <group>
                            <field name="origin_common_name"/>
                            <field name="origin_product_id"/>
                            <field name="standard_price_target"/>
                            <field name="origin_manufacturer"/>
                            <field name="origin_product_origin"/>
                            <field name="origin_description"/>
                            <field name="origin_attachments"/>
                        </group>
                        <group>
                            <field name="selected_common_name"/>
                            <field name="selected_product_id"/>
                            <field name="selected_price"/>
                            <field name="other_costs"/>
                            <field name="selected_manufacturer"/>
                            <field name="selected_product_origin"/>
                            <field name="selected_partner"/>
                            <field name="selected_description"/>
                            <field name="selected_attachments"/>
                            <field name="selected_price_lines" invisible="1"/>
                        </group>
                        <label for="note" string="Ghi chú"/>
                        <field name="note" placeholder="Ghi chú từ nhà sản xuất đã chọn"/>
                    </group>

                    <notebook>
                        <page string="Chi tiết">
                            <field name="price_lines"/>
                        </page>
                    </notebook>

                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!--ir.actions.server-->
    <record model="ir.actions.server" id="model_sale_order_price_list_product_action_create_purchase">
        <field name="name">Tạo yêu cầu mua hàng</field>
        <field name="model_id" ref="ext_sale.model_sale_order_price_list_product"/>
        <field name="binding_model_id" ref="ext_sale.model_sale_order_price_list_product"/>
        <field name="binding_view_types">list</field>
        <field name="state">code</field>
        <field name="code">
             action = records.action_create_purchase()
        </field>
     </record>

    <!--filter-->
    <record id="view_price_list_filter" model="ir.ui.view">
        <field name="name">price.list.select</field>
        <field name="model">sale.order.price.list.product</field>
        <field name="arch" type="xml">
            <search string="Tìm kiếm bảng giá">
                <field name="name"/>
                <field name="origin"/>
                <field name="selected_partner"/>
                <filter string="Trạng thái - trong quá trình" name="state" domain="[('state','=','processing')]"/>
                <filter string="Trạng thái - đã chọn giá" name="state" domain="[('state','=','selected')]"/>
                <filter string="Trạng thái - đã mua" name="state" domain="[('state','=','buyed')]"/>
                <group expand="0" string="Group By">
                    <filter string="NCC mua hàng" name="selectedpartner" domain="[]" context="{'group_by': 'selected_partner'}"/>
                    <filter string="Yêu cầu mua hàng" name="origin" domain="[]" context="{'group_by': 'origin'}"/>
                </group>
           </search>
        </field>
    </record>
</odoo>